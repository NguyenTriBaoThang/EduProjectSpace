<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Xem chi ti·∫øt ƒë·ªÅ t√†i ƒë·ªì √°n c·ªßa h·ªá th·ªëng Sinh vi√™n HUTECH.">
    <meta name="copyright" content="¬© 2025 - Nh√≥m TAD Programmer Khoa C√¥ng ngh·ªá Th√¥ng tin - Tr∆∞·ªùng ƒê·∫°i h·ªçc C√¥ng ngh·ªá TP.HCM - HUTECH. T·∫•t c·∫£ quy·ªÅn ƒë∆∞·ª£c b·∫£o l∆∞u.">
    <title>Xem chi ti·∫øt ƒë·ªÅ t√†i ƒë·ªì √°n | H·ªá th·ªëng Sinh vi√™n</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <link href="styles.css" rel="stylesheet">
    <link href="img/img_logohutech.png" type="image/png" rel="icon">
</head>
<body>
    <!-- Sidebar -->
    <div class="sidebar" id="sidebar">
        <h4 class="text-center mb-4">üéì H·ªá th·ªëng Sinh vi√™n</h4>
        <a href="student_dashboard.html"><i class="bi bi-house-door"></i> Trang ch·ªß</a>
        <a href="student_submissions_list.html"><i class="bi bi-upload"></i> N·ªôp b√†i t·∫≠p ƒë·ªì √°n</a>
        <a href="student_tracking_list.html"><i class="bi bi-bar-chart-line"></i> Theo d√µi ti·∫øn ƒë·ªô ƒë·ªì √°n</a>
        <a href="student_history_submissions_list.html"><i class="bi bi-clock-history"></i> Xem l·ªãch s·ª≠ n·ªôp b√†i</a>
        <a href="student_proposals_list.html" class="active"><i class="bi bi-lightbulb"></i> ƒê·ªÅ xu·∫•t ƒë·ªÅ t√†i ƒë·ªì √°n</a>
        <a href="student_schedule.html"><i class="bi bi-calendar"></i> L·ªãch c√° nh√¢n</a>
        <a href="student_grades_list.html"><i class="bi bi-award"></i> H·ªá th·ªëng ch·∫•m ƒëi·ªÉm</a>
    </div>

    <!-- Main Content -->
    <div class="content">
        <!-- Navbar -->
        <nav class="navbar navbar-expand-lg px-3">
            <button id="toggleSidebarBtn" class="btn btn-outline-light me-2">
                <i id="sidebarIcon" class="bi bi-list"></i>
            </button>            
            <div class="ms-auto d-flex align-items-center">
                <input type="text" class="search-box me-3" placeholder="üîç T√¨m ki·∫øm...">
                <button id="toggleFullscreen" class="btn"><i class="bi bi-arrows-fullscreen"></i></button>
                <button id="toggleTheme" class="btn"><i class="bi bi-moon"></i></button>
                <button id="notificationBtn" class="btn"><i class="bi bi-bell"></i></button>
                <button id="profileBtn" class="btn"><i class="bi bi-person-circle"></i></button>
            </div>
        </nav>

        <!-- Profile Dropdown -->
        <div class="profile-dropdown" id="profileDropdown">
            <div class="profile-header">
                <img src="img/avatar.jpg" alt="User Avatar">
                <h6>Nguy·ªÖn Tri B√£o Th·∫Øng</h6>
                <p>nguyentribaothang@gmail.com</p>
            </div>
            <div class="profile-menu">
                <a href="#"><i class="bi bi-gear"></i> C√†i ƒë·∫∑t hi·ªÉn th·ªã</a>
                <a href="#" id="toggleFullscreenBtn"><i class="bi bi-arrows-fullscreen"></i> To√†n m√†n h√¨nh</a>
                <a href="#"><i class="bi bi-arrow-clockwise"></i> Kh√¥i ph·ª•c m·∫∑c ƒë·ªãnh</a>
                <a href="../LOGIN/login.html" class="logout"><i class="bi bi-box-arrow-right"></i> ƒêƒÉng xu·∫•t</a>
            </div>
        </div>

        <div class="container mt-4">
            <h2 class="fw-bold text-primary">üìã Xem chi ti·∫øt ƒë·ªÅ t√†i ƒë·ªì √°n</h2>

            <!-- Breadcrumb -->
            <nav class="breadcrumb-container">
                <ol class="breadcrumb">
                    <li class="breadcrumb-item">
                        <a href="student_dashboard.html"><i class="bi bi-house-door"></i></a>
                    </li>
                    <li class="breadcrumb-item">
                        <a href="student_proposals_list.html"><i class="bi bi-list-ul"></i> Danh s√°ch ƒë·ªÅ xu·∫•t</a>
                    </li>
                    <li class="breadcrumb-item active">
                        <i class="bi bi-file-earmark-text"></i> Chi ti·∫øt ƒë·ªÅ xu·∫•t
                    </li>
                </ol>
            </nav>

            <!-- Section n·ªôi dung chi ti·∫øt -->
            <div class="card mt-4" id="proposalDetails">
                <div class="card-header d-flex justify-content-between align-items-center">
                    <div>
                        <h5 class="text-uppercase" id="proposalTitle"></h5>
                        <span id="proposalStatus" class="badge"></span>
                    </div>
                    <button class="btn btn-info btn-sm" onclick="exportProposal()">Xu·∫•t Excel <i class="bi bi-file-earmark-excel"></i></button>
                </div>
                <div class="card-body">
                    <h5 class="card-title">Th√¥ng tin chi ti·∫øt ƒë·ªÅ t√†i</h5>
                    <p class="card-text">
                        <strong>Lo·∫°i ƒë·ªì √°n:</strong> <span id="proposalType"></span> <br>
                        <strong>Ng√†y ƒë·ªÅ xu·∫•t:</strong> <span id="proposalDate"></span> <br>
                        <strong>Ng∆∞·ªùi ƒë·ªÅ xu·∫•t:</strong> <span id="proposer"></span> <br>
                        <strong>M√¥ t·∫£:</strong> <span id="proposalDescription"></span>
                    </p>

                    <!-- G·ª£i √Ω t·ª´ gi·∫£ng vi√™n -->
                    <div class="alert alert-info" role="alert" id="teacherFeedback">
                        <h5 class="alert-heading">G·ª£i √Ω t·ª´ gi·∫£ng vi√™n:</h5>
                        <p id="feedbackText"></p>
                    </div>
                </div>

                <!-- Ph·∫ßn file ƒë√≠nh k√®m -->
                <div class="card-footer text-muted">
                    <strong>File ƒë√≠nh k√®m:</strong>
                    <ul class="file-list" id="fileList"></ul>
                    <button class="btn btn-outline-primary btn-sm mt-2" onclick="downloadAllFiles()">T·∫£i t·∫•t c·∫£ file</button>
                </div>
            </div>

            <!-- N√∫t quay l·∫°i danh s√°ch ƒë·ªÅ t√†i -->
            <div class="mt-4 text-right">
                <a href="student_proposals_list.html" class="btn btn-secondary btn-back">
                    <i class="bi bi-arrow-left-circle"></i> Quay l·∫°i danh s√°ch ƒë·ªÅ t√†i
                </a>
            </div>
        </div>
    </div>

    <div class="footer">
        B·∫£n quy·ªÅn c·ªßa HUTECH ‚Äì Ph√°t tri·ªÉn b·ªüi Team TAD Programmer ¬©2025
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // D·ªØ li·ªáu m·∫´u ƒë·ªÅ t√†i
        const proposals = {
            "1": {
                title: "ƒê·ªì √°n c∆° s·ªü: X√¢y d·ª±ng h·ªá th·ªëng qu·∫£n l√Ω sinh vi√™n",
                status: "ƒê√£ duy·ªát",
                type: "Chuy√™n ng√†nh",
                date: "10-02-2025",
                proposer: "Nguy·ªÖn Tri B√£o Th·∫Øng",
                description: "ƒê√¢y l√† ƒë·ªÅ t√†i ƒë·ªì √°n c∆° s·ªü v·ªõi c√°c m·ª•c ti√™u nghi√™n c·ª©u v·ªÅ ·ª©ng d·ª•ng c√¥ng ngh·ªá trong ph√°t tri·ªÉn ph·∫ßn m·ªÅm, bao g·ªìm vi·ªác s·ª≠ d·ª•ng c√°c c√¥ng c·ª• hi·ªán ƒë·∫°i nh∆∞ Java, Spring Boot, v√† c∆° s·ªü d·ªØ li·ªáu MySQL.",
                feedback: "ƒê·ªÅ t√†i n√†y ƒë√£ ƒë∆∞·ª£c duy·ªát. B·∫°n c·∫ßn ch√∫ tr·ªçng v√†o ph·∫ßn ph√¢n t√≠ch h·ªá th·ªëng v√† t·ªëi ∆∞u h√≥a c√°c quy tr√¨nh. N√™n t·∫≠p trung v√†o vi·ªác ·ª©ng d·ª•ng c√°c c√¥ng ngh·ªá m·ªõi v√† c√≥ th·ªÉ m·ªü r·ªông h·ªá th·ªëng sau khi ho√†n th√†nh.",
                files: [
                    { name: "proposal_document.pdf", url: "#" },
                    { name: "system_design.png", url: "#" }
                ]
            },
            "2": {
                title: "ƒê·ªì √°n chuy√™n ng√†nh: ·ª®ng d·ª•ng di ƒë·ªông ƒë·∫∑t v√© xe",
                status: "Ch∆∞a duy·ªát",
                type: "Chuy√™n ng√†nh",
                date: "15-02-2025",
                proposer: "Nguy·ªÖn Tri B√£o Th·∫Øng",
                description: "Ph√°t tri·ªÉn ·ª©ng d·ª•ng di ƒë·ªông ƒë·∫∑t v√© xe s·ª≠ d·ª•ng Flutter v√† Firebase ƒë·ªÉ qu·∫£n l√Ω d·ªØ li·ªáu th·ªùi gian th·ª±c.",
                feedback: "ƒê·ªÅ t√†i c·∫ßn b·ªï sung th√™m ph·∫ßn ph√¢n t√≠ch y√™u c·∫ßu v√† k·∫ø ho·∫°ch tri·ªÉn khai chi ti·∫øt h∆°n.",
                files: [
                    { name: "mobile_app_proposal.docx", url: "#" }
                ]
            }
        };

        // Navbar Functions
        document.getElementById("toggleSidebarBtn").addEventListener("click", () => {
            const sidebar = document.querySelector(".sidebar");
            const content = document.querySelector(".content");
            const icon = document.getElementById("sidebarIcon");
            sidebar.classList.toggle("collapsed");
            content.classList.toggle("expanded");
            icon.classList.toggle("bi-list");
            icon.classList.toggle("bi-layout-sidebar-inset");
        });

        document.getElementById("notificationBtn").addEventListener("click", () => {
            window.location.href = "notifications_list.html";
        });

        document.getElementById("profileBtn").addEventListener("click", (event) => {
            event.stopPropagation();
            const dropdown = document.getElementById("profileDropdown");
            dropdown.style.display = dropdown.style.display === "block" ? "none" : "block";
        });

        document.addEventListener("click", (event) => {
            const dropdown = document.getElementById("profileDropdown");
            if (!dropdown.contains(event.target) && event.target.id !== "profileBtn") {
                dropdown.style.display = "none";
            }
        });

        document.getElementById("toggleFullscreen").addEventListener("click", () => {
            if (!document.fullscreenElement) document.documentElement.requestFullscreen();
            else document.exitFullscreen();
        });

        document.getElementById("toggleFullscreenBtn").addEventListener("click", () => {
            if (!document.fullscreenElement) document.documentElement.requestFullscreen();
            else document.exitFullscreen();
        });

        document.getElementById("toggleTheme").addEventListener("click", () => {
            document.body.classList.toggle("dark-mode");
            localStorage.setItem("theme", document.body.classList.contains("dark-mode") ? "dark" : "light");
        });

        if (localStorage.getItem("theme") === "dark") document.body.classList.add("dark-mode");

        // L·∫•y th√¥ng tin ƒë·ªÅ t√†i t·ª´ URL
        const params = new URLSearchParams(window.location.search);
        const proposalId = params.get("id");

        function loadProposal() {
            const proposal = proposals[proposalId];
            if (proposal) {
                document.getElementById("proposalTitle").textContent = `ƒê·ªÅ t√†i: ${proposal.title}`;
                document.getElementById("proposalStatus").textContent = proposal.status;
                document.getElementById("proposalStatus").className = `badge ${proposal.status === "ƒê√£ duy·ªát" ? "bg-success" : "bg-warning"}`;
                document.getElementById("proposalType").textContent = proposal.type;
                document.getElementById("proposalDate").textContent = proposal.date;
                document.getElementById("proposer").textContent = proposal.proposer;
                document.getElementById("proposalDescription").textContent = proposal.description;
                document.getElementById("feedbackText").textContent = proposal.feedback;

                const fileList = document.getElementById("fileList");
                fileList.innerHTML = "";
                proposal.files.forEach(file => {
                    fileList.innerHTML += `<li><a href="${file.url}" download class="btn btn-outline-primary btn-sm">üì• ${file.name}</a></li>`;
                });
            } else {
                document.getElementById("proposalDetails").innerHTML = "<p class='p-4'>Kh√¥ng t√¨m th·∫•y ƒë·ªÅ t√†i v·ªõi ID n√†y.</p>";
            }
        }

        // T·∫£i t·∫•t c·∫£ file ƒë√≠nh k√®m
        function downloadAllFiles() {
            const proposal = proposals[proposalId];
            if (proposal && proposal.files.length > 0) {
                proposal.files.forEach(file => {
                    const link = document.createElement("a");
                    link.href = file.url;
                    link.download = file.name;
                    document.body.appendChild(link);
                    link.click();
                    document.body.removeChild(link);
                });
            } else {
                alert("Kh√¥ng c√≥ file n√†o ƒë·ªÉ t·∫£i!");
            }
        }

        // Xu·∫•t b√°o c√°o Excel
        function exportProposal() {
            const proposal = proposals[proposalId];
            if (!proposal) return;

            const worksheetData = [
                [`Chi ti·∫øt ƒë·ªÅ t√†i ƒë·ªì √°n - ${proposal.title}`],
                ["Tr·∫°ng th√°i", proposal.status],
                ["Lo·∫°i ƒë·ªì √°n", proposal.type],
                ["Ng√†y ƒë·ªÅ xu·∫•t", proposal.date],
                ["Ng∆∞·ªùi ƒë·ªÅ xu·∫•t", proposal.proposer],
                ["M√¥ t·∫£", proposal.description],
                ["G·ª£i √Ω t·ª´ gi·∫£ng vi√™n", proposal.feedback],
                ["File ƒë√≠nh k√®m", proposal.files.map(f => f.name).join(", ")]
            ];

            const worksheet = XLSX.utils.aoa_to_sheet(worksheetData);
            const workbook = XLSX.utils.book_new();
            XLSX.utils.book_append_sheet(workbook, worksheet, "ChiTietDeTai");
            XLSX.writeFile(workbook, `de_tai_${proposalId}.xlsx`);
        }

        // Kh·ªüi ch·∫°y
        loadProposal();
    </script>
</body>
</html>