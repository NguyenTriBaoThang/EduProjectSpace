<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="ƒê·ªÅ xu·∫•t ƒë·ªÅ t√†i ƒë·ªì √°n c·ªßa h·ªá th·ªëng Sinh vi√™n HUTECH.">
    <meta name="copyright" content="¬© 2025 - Nh√≥m TAD Programmer Khoa C√¥ng ngh·ªá Th√¥ng tin - Tr∆∞·ªùng ƒê·∫°i h·ªçc C√¥ng ngh·ªá TP.HCM - HUTECH. T·∫•t c·∫£ quy·ªÅn ƒë∆∞·ª£c b·∫£o l∆∞u.">
    <title>ƒê·ªÅ xu·∫•t ƒë·ªÅ t√†i ƒë·ªì √°n | H·ªá th·ªëng Sinh vi√™n</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <link href="styles.css" rel="stylesheet">
    <link href="img/img_logohutech.png" type="image/png" rel="icon">
</head>
<body>
    <!-- Sidebar -->
    <div class="sidebar" id="sidebar">
        <h4 class="text-center mb-4">üéì H·ªá th·ªëng Sinh vi√™n</h4>
        <a href="student_dashboard.html"><i class="bi bi-house-door"></i> Trang ch·ªß</a>
        <a href="student_submissions_list.html"><i class="bi bi-upload"></i> N·ªôp b√†i t·∫≠p ƒë·ªì √°n</a>
        <a href="student_tracking_list.html"><i class="bi bi-bar-chart-line"></i> Theo d√µi ti·∫øn ƒë·ªô ƒë·ªì √°n</a>
        <a href="student_history_submissions_list.html"><i class="bi bi-clock-history"></i> Xem l·ªãch s·ª≠ n·ªôp b√†i</a>
        <a href="student_proposals_list.html" class="active"><i class="bi bi-lightbulb"></i> ƒê·ªÅ xu·∫•t ƒë·ªÅ t√†i ƒë·ªì √°n</a>
        <a href="student_schedule.html"><i class="bi bi-calendar"></i> L·ªãch c√° nh√¢n</a>
        <a href="student_grades_list.html"><i class="bi bi-award"></i> H·ªá th·ªëng ch·∫•m ƒëi·ªÉm</a>
    </div>

    <!-- Main Content -->
    <div class="content">
        <!-- Navbar -->
        <nav class="navbar navbar-expand-lg px-3">
            <button id="toggleSidebarBtn" class="btn btn-outline-light me-2">
                <i id="sidebarIcon" class="bi bi-list"></i>
            </button>            
            <div class="ms-auto d-flex align-items-center">
                <input type="text" class="search-box me-3" placeholder="üîç T√¨m ki·∫øm...">
                <button id="toggleFullscreen" class="btn"><i class="bi bi-arrows-fullscreen"></i></button>
                <button id="toggleTheme" class="btn"><i class="bi bi-moon"></i></button>
                <button id="notificationBtn" class="btn"><i class="bi bi-bell"></i></button>
                <button id="profileBtn" class="btn"><i class="bi bi-person-circle"></i></button>
            </div>
        </nav>

        <!-- Profile Dropdown -->
        <div class="profile-dropdown" id="profileDropdown">
            <div class="profile-header">
                <img src="img/avatar.jpg" alt="User Avatar">
                <h6>Nguy·ªÖn Tri B√£o Th·∫Øng</h6>
                <p>nguyentribaothang@gmail.com</p>
            </div>
            <div class="profile-menu">
                <a href="#"><i class="bi bi-gear"></i> C√†i ƒë·∫∑t hi·ªÉn th·ªã</a>
                <a href="#" id="toggleFullscreenBtn"><i class="bi bi-arrows-fullscreen"></i> To√†n m√†n h√¨nh</a>
                <a href="#"><i class="bi bi-arrow-clockwise"></i> Kh√¥i ph·ª•c m·∫∑c ƒë·ªãnh</a>
                <a href="../LOGIN/login.html" class="logout"><i class="bi bi-box-arrow-right"></i> ƒêƒÉng xu·∫•t</a>
            </div>
        </div>

        <!-- Proposal Section -->
        <div class="container mt-4">
            <h2 class="fw-bold text-primary">üí° ƒê·ªÅ xu·∫•t ƒë·ªÅ t√†i ƒë·ªì √°n</h2>

            <!-- Breadcrumb -->
            <nav class="breadcrumb-container">
                <ol class="breadcrumb">
                    <li class="breadcrumb-item">
                        <a href="student_dashboard.html"><i class="bi bi-house-door"></i></a>
                    </li>
                    <li class="breadcrumb-item">
                        <a href="student_proposals_list.html"><i class="bi bi-list-ul"></i> Danh s√°ch ƒë·ªÅ xu·∫•t</a>
                    </li>
                    <li class="breadcrumb-item active">
                        <i class="bi bi-lightbulb"></i> ƒê·ªÅ xu·∫•t ƒë·ªÅ t√†i
                    </li>
                </ol>
            </nav>

            <form id="proposalForm" class="mt-4" onsubmit="submitProposal(event)">
                <div class="mb-3">
                    <label class="form-label">M√¥n h·ªçc</label>
                    <select id="subject" class="form-select" name="subject" required>
                        <option value="">-- Ch·ªçn m√¥n h·ªçc --</option>
                        <option value="K·ªπ thu·∫≠t l·∫≠p tr√¨nh">K·ªπ thu·∫≠t l·∫≠p tr√¨nh</option>
                        <option value="ƒê·ªì √°n chuy√™n ng√†nh">ƒê·ªì √°n chuy√™n ng√†nh</option>
                        <option value="ƒê·ªì √°n c∆° s·ªü">ƒê·ªì √°n c∆° s·ªü</option>
                    </select>
                </div>
                <div class="mb-3">
                    <label class="form-label">T√™n ƒë·ªÅ t√†i</label>
                    <input type="text" id="title" class="form-control" name="title" placeholder="Nh·∫≠p t√™n ƒë·ªÅ t√†i" required>
                </div>
                <div class="mb-3">
                    <label class="form-label">M√¥ t·∫£ ng·∫Øn</label>
                    <textarea id="description" class="form-control" name="description" rows="3" placeholder="M√¥ t·∫£ ng·∫Øn v·ªÅ ƒë·ªÅ t√†i" required></textarea>
                </div>
                <div class="mb-3">
                    <label class="form-label">C√¥ng ngh·ªá s·ª≠ d·ª•ng</label>
                    <input type="text" id="technology" class="form-control" name="technology" placeholder="V√≠ d·ª•: Java, Spring Boot, Flutter..." required>
                </div>
                <div class="mb-3">
                    <label class="form-label">File ƒë√≠nh k√®m (n·∫øu c√≥)</label>
                    <input type="file" id="attachment" class="form-control" name="attachment" onchange="displayFileName()">
                    <small id="fileName" class="form-text text-muted"></small>
                </div>
                <div class="text-center d-flex justify-content-center gap-2">
                    <button type="button" class="btn btn-primary" onclick="showConfirmation()">G·ª≠i ƒë·ªÅ xu·∫•t</button>
                    <a href="student_proposals_list.html" class="btn btn-secondary btn-back"><i class="bi bi-arrow-left-circle"></i> Quay l·∫°i danh s√°ch</a>
                </div>
            </form>
        </div>

        <!-- Modal Confirmation -->
        <div class="modal fade" id="confirmationModal" tabindex="-1" aria-labelledby="confirmationModalLabel" aria-hidden="true">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="confirmationModalLabel">X√°c nh·∫≠n ƒë·ªÅ xu·∫•t</h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body">
                        <p>B·∫°n ƒë√£ ch·∫Øc ch·∫Øn mu·ªën g·ª≠i ƒë·ªÅ xu·∫•t ch∆∞a? H√£y xem k·ªπ th√¥ng tin tr∆∞·ªõc khi g·ª≠i.</p>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">H·ªßy</button>
                        <button type="button" class="btn btn-primary" onclick="submitForm()">X√°c nh·∫≠n</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Modal Success -->
        <div class="modal fade" id="successModal" tabindex="-1" aria-labelledby="successModalLabel" aria-hidden="true">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="successModalLabel">G·ª≠i ƒë·ªÅ xu·∫•t th√†nh c√¥ng</h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body">
                        <p>ƒê·ªÅ xu·∫•t c·ªßa b·∫°n ƒë√£ ƒë∆∞·ª£c g·ª≠i th√†nh c√¥ng!</p>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-primary" data-bs-dismiss="modal" onclick="redirectToList()">OK</button>
                    </div>
                </div>
            </div>
        </div>

    </div>

    <div class="footer">
        B·∫£n quy·ªÅn c·ªßa HUTECH ‚Äì Ph√°t tri·ªÉn b·ªüi Team TAD Programmer ¬©2025
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // Navbar Functions
        document.getElementById("toggleSidebarBtn").addEventListener("click", () => {
            const sidebar = document.querySelector(".sidebar");
            const content = document.querySelector(".content");
            const icon = document.getElementById("sidebarIcon");
            sidebar.classList.toggle("collapsed");
            content.classList.toggle("expanded");
            icon.classList.toggle("bi-list");
            icon.classList.toggle("bi-layout-sidebar-inset");
        });

        document.getElementById("notificationBtn").addEventListener("click", () => {
            window.location.href = "notifications_list.html";
        });

        document.getElementById("profileBtn").addEventListener("click", (event) => {
            event.stopPropagation();
            const dropdown = document.getElementById("profileDropdown");
            dropdown.style.display = dropdown.style.display === "block" ? "none" : "block";
        });

        document.addEventListener("click", (event) => {
            const dropdown = document.getElementById("profileDropdown");
            if (!dropdown.contains(event.target) && event.target.id !== "profileBtn") {
                dropdown.style.display = "none";
            }
        });

        document.getElementById("toggleFullscreen").addEventListener("click", () => {
            if (!document.fullscreenElement) document.documentElement.requestFullscreen();
            else document.exitFullscreen();
        });

        document.getElementById("toggleFullscreenBtn").addEventListener("click", () => {
            if (!document.fullscreenElement) document.documentElement.requestFullscreen();
            else document.exitFullscreen();
        });

        document.getElementById("toggleTheme").addEventListener("click", () => {
            document.body.classList.toggle("dark-mode");
            localStorage.setItem("theme", document.body.classList.contains("dark-mode") ? "dark" : "light");
        });

        if (localStorage.getItem("theme") === "dark") document.body.classList.add("dark-mode");

        // Hi·ªÉn th·ªã t√™n file ƒë√£ ch·ªçn
        function displayFileName() {
            const fileInput = document.getElementById("attachment");
            const fileName = document.getElementById("fileName");
            if (fileInput.files.length > 0) {
                fileName.textContent = `File ƒë√£ ch·ªçn: ${fileInput.files[0].name}`;
            } else {
                fileName.textContent = "";
            }
        }

        // Hi·ªÉn th·ªã modal x√°c nh·∫≠n
        function showConfirmation() {
            const form = document.getElementById("proposalForm");
            if (form.checkValidity()) {
                const confirmationModal = new bootstrap.Modal(document.getElementById('confirmationModal'));
                confirmationModal.show();
            } else {
                form.reportValidity();
            }
        }

        // G·ª≠i form v√† xu·∫•t Excel
        function submitForm() {
            const form = document.getElementById("proposalForm");
            const formData = new FormData(form);

            const proposalData = {
                subject: formData.get("subject"),
                title: formData.get("title"),
                description: formData.get("description"),
                technology: formData.get("technology"),
                attachment: formData.get("attachment") ? formData.get("attachment").name : "Kh√¥ng c√≥ file"
            };

            // Xu·∫•t Excel
            const worksheetData = [
                ["ƒê·ªÅ xu·∫•t ƒë·ªÅ t√†i ƒë·ªì √°n"],
                ["M√¥n h·ªçc", proposalData.subject],
                ["T√™n ƒë·ªÅ t√†i", proposalData.title],
                ["M√¥ t·∫£ ng·∫Øn", proposalData.description],
                ["C√¥ng ngh·ªá s·ª≠ d·ª•ng", proposalData.technology],
                ["File ƒë√≠nh k√®m", proposalData.attachment]
            ];

            const worksheet = XLSX.utils.aoa_to_sheet(worksheetData);
            const workbook = XLSX.utils.book_new();
            XLSX.utils.book_append_sheet(workbook, worksheet, "DeXuatDeTai");
            XLSX.writeFile(workbook, `de_xuat_${proposalData.title.replace(/\s+/g, '_')}.xlsx`);

            // Hi·ªÉn th·ªã modal th√†nh c√¥ng
            const confirmationModal = bootstrap.Modal.getInstance(document.getElementById('confirmationModal'));
            confirmationModal.hide();
            const successModal = new bootstrap.Modal(document.getElementById('successModal'));
            successModal.show();
        }

        // Chuy·ªÉn h∆∞·ªõng sau khi g·ª≠i th√†nh c√¥ng
        function redirectToList() {
            window.location.href = "student_proposals_list.html";
        }

        // X·ª≠ l√Ω submit form
        function submitProposal(event) {
            event.preventDefault();
            showConfirmation();
        }
    </script>
</body>
</html>