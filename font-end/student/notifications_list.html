<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Danh s√°ch th√¥ng b√°o c·ªßa h·ªá th·ªëng Sinh vi√™n HUTECH.">
    <meta name="copyright" content="¬© 2025 - Nh√≥m TAD Programmer Khoa C√¥ng ngh·ªá Th√¥ng tin - Tr∆∞·ªùng ƒê·∫°i h·ªçc C√¥ng ngh·ªá TP.HCM - HUTECH. T·∫•t c·∫£ quy·ªÅn ƒë∆∞·ª£c b·∫£o l∆∞u.">
    <title>Danh s√°ch Th√¥ng b√°o | H·ªá th·ªëng Sinh vi√™n</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="styles.css" rel="stylesheet">
    <link rel="icon" href="img/img_logohutech.png" type="image/png">
</head>
<body>
    <!-- Sidebar -->
    <div class="sidebar" id="sidebar">
        <h4 class="text-center mb-4">üéì H·ªá th·ªëng Sinh vi√™n</h4>
        <a href="student_dashboard.html"><i class="bi bi-house-door"></i> Trang ch·ªß</a>
        <a href="student_submissions_list.html"><i class="bi bi-upload"></i> N·ªôp b√†i t·∫≠p ƒë·ªì √°n</a>
        <a href="student_tracking_list.html"><i class="bi bi-bar-chart-line"></i> Theo d√µi ti·∫øn ƒë·ªô ƒë·ªì √°n</a>
        <a href="student_history_submissions_list.html"><i class="bi bi-clock-history"></i> Xem l·ªãch s·ª≠ n·ªôp b√†i</a>
        <a href="student_proposals_list.html"><i class="bi bi-lightbulb"></i> ƒê·ªÅ xu·∫•t ƒë·ªÅ t√†i ƒë·ªì √°n</a>
        <a href="student_schedule.html"><i class="bi bi-calendar"></i> L·ªãch c√° nh√¢n</a>
        <a href="student_grades_list.html"><i class="bi bi-award"></i> H·ªá th·ªëng ch·∫•m ƒëi·ªÉm</a>
    </div>

    <!-- Main Content -->
    <div class="content">
        <!-- Navbar -->
        <nav class="navbar navbar-expand-lg px-3">
            <button id="toggleSidebarBtn" class="btn btn-outline-light me-2">
                <i id="sidebarIcon" class="bi bi-list"></i>
            </button>            
            <div class="ms-auto d-flex align-items-center">
                <input type="text" class="search-box me-3" placeholder="üîç T√¨m ki·∫øm..." id="searchInput" onkeyup="filterNotifications()">
                <button id="toggleFullscreen" class="btn"><i class="bi bi-arrows-fullscreen"></i></button>
                <button id="toggleTheme" class="btn"><i class="bi bi-moon"></i></button>
                <button id="notificationBtn" class="btn position-relative">
                    <i class="bi bi-bell"></i>
                    <span class="badge bg-danger position-absolute top-0 start-100 translate-middle" id="unreadCount">0</span>
                </button>
                <button id="profileBtn" class="btn"><i class="bi bi-person-circle"></i></button>
            </div>
        </nav>

        <!-- Profile Dropdown -->
        <div class="profile-dropdown" id="profileDropdown">
            <div class="profile-header">
                <img src="img/avatar.jpg" alt="User Avatar">
                <h6>Nguy·ªÖn Tri B√£o Th·∫Øng</h6>
                <p>nguyentribaothang@gmail.com</p>
            </div>
            <div class="profile-menu">
                <a href="#"><i class="bi bi-gear"></i> C√†i ƒë·∫∑t hi·ªÉn th·ªã</a>
                <a href="#" id="toggleFullscreenBtn"><i class="bi bi-arrows-fullscreen"></i> To√†n m√†n h√¨nh</a>
                <a href="#"><i class="bi bi-arrow-clockwise"></i> Kh√¥i ph·ª•c m·∫∑c ƒë·ªãnh</a>
                <a href="../LOGIN/login.html" class="logout"><i class="bi bi-box-arrow-right"></i> ƒêƒÉng xu·∫•t</a>
            </div>
        </div>

        <div class="container mt-4 notification-container">
            <!-- Breadcrumb -->
            <nav class="breadcrumb-container">
                <ol class="breadcrumb">
                    <li class="breadcrumb-item">
                        <a href="student_dashboard.html"><i class="bi bi-house-door"></i></a>
                    </li>
                    <li class="breadcrumb-item active">
                        <i class="bi bi-bell-fill"></i> Danh s√°ch th√¥ng b√°o
                    </li>
                </ol>
            </nav>

            <!-- Thanh t√¨m ki·∫øm v√† b·ªô l·ªçc -->
            <div class="mb-4 d-flex gap-3">
                <input type="text" class="form-control" id="searchInput" placeholder="üîç T√¨m ki·∫øm th√¥ng b√°o..." onkeyup="filterNotifications()">
                <select class="form-select w-25" id="statusFilter" onchange="filterNotifications()">
                    <option value="">Tr·∫°ng th√°i</option>
                    <option value="unread">Ch∆∞a ƒë·ªçc</option>
                    <option value="read">ƒê√£ ƒë·ªçc</option>
                </select>
            </div>

            <!-- Danh s√°ch th√¥ng b√°o -->
            <div id="notificationList" class="notification-grid"></div>

            <!-- Ph√¢n trang -->
            <div class="pagination-container">
                <ul id="pagination" class="pagination"></ul>
            </div>
        </div>

    </div>

    <!-- Footer -->
    <div class="footer">
        B·∫£n quy·ªÅn c·ªßa HUTECH ‚Äì Ph√°t tri·ªÉn b·ªüi Team TAD Programmer ¬©2025
    </div>

    <!-- Bootstrap Script -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // D·ªØ li·ªáu m·∫´u th√¥ng b√°o
        const notifications = [];
        for (let i = 1; i <= 50; i++) {
            notifications.push({
                id: i,
                title: `Th√¥ng b√°o ${i} - C·∫≠p nh·∫≠t th√¥ng tin quan tr·ªçng`,
                date: `0${i % 9 + 1}/0${i % 12 + 1}/2025`,
                author: `Ng∆∞·ªùi g·ª≠i ${i}`,
                link: `notification_detail.html?id=${i}`,
                status: i % 3 === 0 ? "read" : "unread" // 1/3 th√¥ng b√°o ƒë√£ ƒë·ªçc
            });
        }

        const itemsPerPage = 15;
        let currentPage = 1;

        // Navbar Functions
        document.getElementById("toggleSidebarBtn").addEventListener("click", () => {
            const sidebar = document.querySelector(".sidebar");
            const content = document.querySelector(".content");
            const icon = document.getElementById("sidebarIcon");
            sidebar.classList.toggle("collapsed");
            content.classList.toggle("expanded");
            icon.classList.toggle("bi-list");
            icon.classList.toggle("bi-layout-sidebar-inset");
        });

        document.getElementById("notificationBtn").addEventListener("click", () => {
            window.location.href = "notifications_list.html";
        });

        document.getElementById("profileBtn").addEventListener("click", (event) => {
            event.stopPropagation();
            const dropdown = document.getElementById("profileDropdown");
            dropdown.style.display = dropdown.style.display === "block" ? "none" : "block";
        });

        document.addEventListener("click", (event) => {
            const dropdown = document.getElementById("profileDropdown");
            if (!dropdown.contains(event.target) && event.target.id !== "profileBtn") {
                dropdown.style.display = "none";
            }
        });

        document.getElementById("toggleFullscreen").addEventListener("click", () => {
            if (!document.fullscreenElement) document.documentElement.requestFullscreen();
            else document.exitFullscreen();
        });

        document.getElementById("toggleFullscreenBtn").addEventListener("click", () => {
            if (!document.fullscreenElement) document.documentElement.requestFullscreen();
            else document.exitFullscreen();
        });

        document.getElementById("toggleTheme").addEventListener("click", () => {
            document.body.classList.toggle("dark-mode");
            localStorage.setItem("theme", document.body.classList.contains("dark-mode") ? "dark" : "light");
        });

        if (localStorage.getItem("theme") === "dark") document.body.classList.add("dark-mode");

        // Hi·ªÉn th·ªã th√¥ng b√°o
        function displayNotifications(page, filteredNotifications) {
            const start = (page - 1) * itemsPerPage;
            const end = start + itemsPerPage;
            const paginatedNotifications = filteredNotifications.slice(start, end);

            const notificationList = document.getElementById("notificationList");
            notificationList.innerHTML = "";

            if (paginatedNotifications.length === 0) {
                notificationList.innerHTML = '<p class="text-center">Kh√¥ng t√¨m th·∫•y th√¥ng b√°o n√†o.</p>';
            } else {
                paginatedNotifications.forEach(notification => {
                    const statusIcon = notification.status === "unread" ? '<i class="bi bi-circle-fill text-danger me-2"></i>' : "";
                    notificationList.innerHTML += `
                        <div class="notification-card">
                            <div class="notification-avatar">
                                <div class="avatar-circle">${notification.author.charAt(0)}</div>
                            </div>
                            <div class="notification-content">
                                <h6 class="notification-title">${statusIcon}${notification.title}</h6>
                                <div class="notification-meta d-flex justify-content-between">
                                    <span>üìÖ ${notification.date}</span>
                                    <span>üßë‚Äçüíº ${notification.author}</span>
                                </div>
                            </div>
                            <div class="view-detail">
                                <a href="${notification.link}" onclick="markAsRead(${notification.id}); return false;">Xem chi ti·∫øt</a>
                            </div>
                        </div>
                    `;
                });
            }

            document.getElementById("unreadCount").textContent = filteredNotifications.filter(n => n.status === "unread").length;
            setupPagination(filteredNotifications.length);
        }

        // L·ªçc th√¥ng b√°o
        function getFilteredNotifications() {
            const searchText = document.getElementById("searchInput").value.toLowerCase();
            const statusFilter = document.getElementById("statusFilter").value;
            return notifications.filter(notif => {
                const matchesSearch = notif.title.toLowerCase().includes(searchText) || 
                                     notif.date.toLowerCase().includes(searchText) || 
                                     notif.author.toLowerCase().includes(searchText);
                const matchesStatus = statusFilter === "" || notif.status === statusFilter;
                return matchesSearch && matchesStatus;
            }).sort((a, b) => new Date(b.date.split('/').reverse().join('-')) - new Date(a.date.split('/').reverse().join('-')));
        }

        function filterNotifications() {
            currentPage = 1; // Reset v·ªÅ trang ƒë·∫ßu khi l·ªçc
            const filtered = getFilteredNotifications();
            displayNotifications(currentPage, filtered);
        }

        // ƒê√°nh d·∫•u ƒë√£ ƒë·ªçc
        function markAsRead(id) {
            const notification = notifications.find(n => n.id === id);
            if (notification) notification.status = "read";
            const filtered = getFilteredNotifications();
            displayNotifications(currentPage, filtered);
        }

        // Ph√¢n trang
        function setupPagination(totalItems) {
            const totalPages = Math.ceil(totalItems / itemsPerPage);
            const pagination = document.getElementById("pagination");
            pagination.innerHTML = "";

            if (totalItems === 0) return; // Kh√¥ng hi·ªÉn th·ªã ph√¢n trang n·∫øu kh√¥ng c√≥ k·∫øt qu·∫£

            pagination.innerHTML += `<li><a href="#" onclick="changePage(1)">¬´ ƒê·∫ßu</a></li>`;
            if (currentPage > 1) {
                pagination.innerHTML += `<li><a href="#" onclick="changePage(${currentPage - 1})">Tr∆∞·ªõc</a></li>`;
            }

            const maxVisiblePages = 5;
            let startPage = Math.max(1, currentPage - 2);
            let endPage = Math.min(totalPages, startPage + maxVisiblePages - 1);
            if (endPage - startPage < maxVisiblePages - 1) startPage = Math.max(1, endPage - maxVisiblePages + 1);

            for (let i = startPage; i <= endPage; i++) {
                pagination.innerHTML += `<li><a href="#" class="${i === currentPage ? 'active' : ''}" onclick="changePage(${i})">${i}</a></li>`;
            }

            if (currentPage < totalPages) {
                pagination.innerHTML += `<li><a href="#" onclick="changePage(${currentPage + 1})">Sau</a></li>`;
            }
            pagination.innerHTML += `<li><a href="#" onclick="changePage(${totalPages})">Cu·ªëi ¬ª</a></li>`;
        }

        function changePage(page) {
            currentPage = page;
            const filtered = getFilteredNotifications();
            displayNotifications(currentPage, filtered);
        }

        // Kh·ªüi ch·∫°y
        const initialFiltered = getFilteredNotifications();
        displayNotifications(currentPage, initialFiltered);
    </script>
</body>
</html>